### 时间戳检测死锁

基于时间戳进行死锁检测是将每一个事务与一个时间戳关联起来，该时间戳与基于时间戳并发控制不同，该时间戳仅用于死锁检测，且该时间戳在事务进行重置后仍不变。

时间戳在事务 T 等待另一事务 U 持有的锁时，根据时间戳的大小可以有两种不同的方案。

（1） 等待-死亡方案：

如果事务 T 的时间戳比事务 U 小（T 先开始），那么允许事务 T 等待事务 U 持有的锁；
如果事务 T 的时间戳比事务 U 大（U 先开始），那么事务 T“死亡”，T 进行回滚；

（2）伤害-等待方案：

如果事务 T 的时间戳比事务 U 小（T 先开始），事务 T“伤害”事务 U，事务 U 必须回滚，并放弃事务 U 持有的锁；
如果事务 T 的时间戳比事务 U 大（U 先开始），那么事务 T 将等待事务 U 持有的锁
