```
中文名：《操作系统导论》
英文名：《Operating Systems: Three Easy Pieces》
作者：Remzi H. Arpaci-Dusseau and Andrea C. Arpaci-Dusseau
英文版是免费开放的：http://pages.cs.wisc.edu/~remzi/OSTEP/
```

# 目录

不闻不若闻之，闻之不若见之，见之不若知之，知之不若行之——荀子

### 1. 操作系统为什么将资源虚拟化？

答案显而易见：让系统更易于使用。

操作系统将物理资源（CPU，磁盘，内存等）转换为更通用、更强大且更易于使用的虚拟形式。我们有时将操作系统称为虚拟机。

为了让用户使用虚拟机的功能，操作系统会提供系统调用。

操作系统有时被称为资源管理器，因为虚拟化让许多程序运行（从而共享 CPU），让许多程序可以同时访问各自的指令和数据（从而共享内存），让许多程序访问设备（从而共享磁盘等）

### 2. 操作系统实际上做了什么？

操作系统

（1）取得 CPU、内存、磁盘等物理资源，并对它们进行虚拟化。

（2）处理与并发有关的麻烦且棘手的问题。

（3）持久地存储文件，从而使它们长期安全。

这就是本书所讲的三个模块。

### 3. 操作系统设计目标

（1）抽象：建立一些抽象，让系统方便和易于使用（不用考虑底层）

（2）高性能：提供高性能，最小化操作系统的开销

（3）隔离/保护：在应用程序之间，应用程序与操作系统之间提供保护（也就是所谓的隔离）

（4）可靠性：应用程序都强依赖操作系统，操作系统必须不间断地运行，操作系统力求提供高度的可靠性

（5）高效，安全，可移植

### 4. 什么是系统调用？

系统调用将控制转移（跳转）到 操作系统中，同时提高硬件特权级别。

用户应用程序以所谓的用户模式运行，这意味着硬件限制了应用程序的功能。例如，以用户模式运行的应用程序通常不能发起对磁盘的 IO 请求，不能访问任何物理内存页，或在网络上发送数据包。

在发起系统调用时（通常通过一个称为 trap 的特殊硬件指令），硬件将控制转移到预先指定的 trap 处理程序（即预先设置的操作系统），并同时将特权级别提升至内核模式。

在内核模式下，操作系统可以完全访问系统的硬件，因此可以执行诸如发起 IO 请求或为程序提供更多内存等功能。当操作系统完成请求的服务时，它通过特殊的 trap 返回指令，将控制权交还给用户。该指令（return-from-trap）返回到用户模式，同时将控制权交还给应用程序，回到应用离开的地方。

# 第一部分：虚拟化

### 1. 进程

进程——操作系统提供的基本抽象。进程的非正式定义言简意赅：进程就是运行中的程序。

进程可以处于以下 3 种状态之一：

- 运行：在 CPU 上运行，执行指令
- 就绪：已准备好运行，但未分配 CPU 时间片
- 阻塞：等待发生其他事件才会准备运行（就绪）

### 2. 如何提供有许多 CPU 的假象？

操作系统通过虚拟化 CPU 来提供这种假象。

通过让一个进程只运行一个时间片，然后切换到其他进程，即所谓的时分共享 CPU 技术。潜在的开销就是性能损失，因为每个进程的运行就会慢一点。

### 3. 机制和策略

机制：一些低级方法或协议，实现了所需的功能。例如上下文切换，它让操作系统能够停止运行一个程序，并开始在给定的 CPU 上运行另外一个程序。

策略：在这些机制之上，策略是在操作系统内做出某种决定的算法。例如给定一组可能的程序要在 CPU 上运行，操作系统如何抉择？操作系统的调度策略会做这样的决定。

### 4. 机制：受限直接执行

在保持控制权的同时，获得高性能，是构建操作系统的主要挑战之一。

# 第二部分：并发

# 第三部分：持久性

# 本书定律一览

### 1. Lampson 定律

重要的是做对事。抽象和简化都不能替代做对事。

有时你必须做正确的事，当你这样做时，总是好过其他方案。
