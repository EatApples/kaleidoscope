
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>6.1 ZooKeeper集群安装 · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="ZooKeeper权限控制.html" />
    
    
    <link rel="prev" href="../" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    0 Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../">
            
                <a href="../">
            
                    
                    1 Algorithm
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../algorithm/CAP.html">
            
                <a href="../algorithm/CAP.html">
            
                    
                    1.1 CAP理论
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../algorithm/ZAB协议.html">
            
                <a href="../algorithm/ZAB协议.html">
            
                    
                    1.2 ZAB协议
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../algorithm/分布式锁.html">
            
                <a href="../algorithm/分布式锁.html">
            
                    
                    1.3 分布式锁
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../algorithm/raft-zh_cn.html">
            
                <a href="../algorithm/raft-zh_cn.html">
            
                    
                    1.4 RAFT算法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../algorithm/PAXOS.html">
            
                <a href="../algorithm/PAXOS.html">
            
                    
                    1.5 3分钟理解PAXOS算法
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../">
            
                <a href="../">
            
                    
                    2 Java
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../java/从实际案例聊聊Java应用的GC优化.html">
            
                <a href="../java/从实际案例聊聊Java应用的GC优化.html">
            
                    
                    2.1 JavaGC优化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../java/设计模式23.html">
            
                <a href="../java/设计模式23.html">
            
                    
                    2.2 设计模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../java/Effective Java.html">
            
                <a href="../java/Effective Java.html">
            
                    
                    2.3 EffectiveJava
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../java/Java学习笔记.html">
            
                <a href="../java/Java学习笔记.html">
            
                    
                    2.4 Java学习笔记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../java/JDK相关.html">
            
                <a href="../java/JDK相关.html">
            
                    
                    2.5 JDK相关
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../java/AlibabaJavaCodingGuidelines.html">
            
                <a href="../java/AlibabaJavaCodingGuidelines.html">
            
                    
                    2.6 阿里Java编码规范整理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="../java/Java程序执行次序.html">
            
                <a href="../java/Java程序执行次序.html">
            
                    
                    2.7 深入了解Java程序执行顺序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="../java/JDK定时任务对比.html">
            
                <a href="../java/JDK定时任务对比.html">
            
                    
                    2.8 JDK定时任务对比
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../">
            
                <a href="../">
            
                    
                    3 SpringBoot
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../springboot/SpringBoot-pom-xml.html">
            
                <a href="../springboot/SpringBoot-pom-xml.html">
            
                    
                    3.1 SpringBoot的pom.xml
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../springboot/SpringBoot注解.html">
            
                <a href="../springboot/SpringBoot注解.html">
            
                    
                    3.2 SpringBoot的注解
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../springboot/Eureka.html">
            
                <a href="../springboot/Eureka.html">
            
                    
                    3.3 Eureka
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../springboot/LogBack相关.html">
            
                <a href="../springboot/LogBack相关.html">
            
                    
                    3.4 LogBack
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../springboot/Maven相关.html">
            
                <a href="../springboot/Maven相关.html">
            
                    
                    3.5 Maven
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../springboot/OAuth2.0.html">
            
                <a href="../springboot/OAuth2.0.html">
            
                    
                    3.6 OAuth2.0
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="../springboot/SpringBoot排错.html">
            
                <a href="../springboot/SpringBoot排错.html">
            
                    
                    3.7 SpringBoot排错
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="../springboot/SpringBoot排雷现场.html">
            
                <a href="../springboot/SpringBoot排雷现场.html">
            
                    
                    3.8 SpringBoot排雷现场
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.9" data-path="../springboot/SpringBoot释疑.html">
            
                <a href="../springboot/SpringBoot释疑.html">
            
                    
                    3.9 SpringBoot释疑
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.10" data-path="../springboot/SpringBoot引入log4j的配置.html">
            
                <a href="../springboot/SpringBoot引入log4j的配置.html">
            
                    
                    3.10 SpringBoot引入log4j的配置
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.11" data-path="../springboot/SpringBoot启动脚本.html">
            
                <a href="../springboot/SpringBoot启动脚本.html">
            
                    
                    3.11 SpringBoot启动脚本
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.12" data-path="../springboot/SpringBoot定时任务.html">
            
                <a href="../springboot/SpringBoot定时任务.html">
            
                    
                    3.12 SpringBoot定时任务
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.13" data-path="../springboot/SpringBoot初始化任务.html">
            
                <a href="../springboot/SpringBoot初始化任务.html">
            
                    
                    3.13 SpringBoot初始化任务
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.14" data-path="../springboot/SpringBootRedis.html">
            
                <a href="../springboot/SpringBootRedis.html">
            
                    
                    3.14 SpringBootRedis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.15" data-path="../springboot/SpringBootRabbitMQ.html">
            
                <a href="../springboot/SpringBootRabbitMQ.html">
            
                    
                    3.15 SpringBootRabbitMQ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.16" data-path="../springboot/packaging为pom标签的用法.html">
            
                <a href="../springboot/packaging为pom标签的用法.html">
            
                    
                    3.16 pom标签
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.17" data-path="../springboot/客户端配置更新.html">
            
                <a href="../springboot/客户端配置更新.html">
            
                    
                    3.17 客户端配置更新
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.18" data-path="../springboot/SpringBoot配置优先级.html">
            
                <a href="../springboot/SpringBoot配置优先级.html">
            
                    
                    3.18 SpringBoot配置优先级
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../">
            
                <a href="../">
            
                    
                    4 RabbitMQ
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../rabbitmq/RabbitMQ相关.html">
            
                <a href="../rabbitmq/RabbitMQ相关.html">
            
                    
                    4.1 RabbitMQ相关
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../rabbitmq/RabbitMQ四种发送方式区别.html">
            
                <a href="../rabbitmq/RabbitMQ四种发送方式区别.html">
            
                    
                    4.2 RabbitMQ四种发送方式区别
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../rabbitmq/RabbitMQ安装全记录.html">
            
                <a href="../rabbitmq/RabbitMQ安装全记录.html">
            
                    
                    4.3 RabbitMQ安装全记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../rabbitmq/RabbitMQ多地址连接.html">
            
                <a href="../rabbitmq/RabbitMQ多地址连接.html">
            
                    
                    4.4 RabbitMQ多地址连接
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../">
            
                <a href="../">
            
                    
                    5 Shell
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../shell/免密登陆.html">
            
                <a href="../shell/免密登陆.html">
            
                    
                    5.1 免密登陆
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../shell/iptables命令.html">
            
                <a href="../shell/iptables命令.html">
            
                    
                    5.2 iptables命令
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../shell/scp命令.html">
            
                <a href="../shell/scp命令.html">
            
                    
                    5.3 scp命令
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../shell/shell特殊变量的含义.html">
            
                <a href="../shell/shell特殊变量的含义.html">
            
                    
                    5.4 shell特殊变量的含义
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../shell/TCP最大连接数.html">
            
                <a href="../shell/TCP最大连接数.html">
            
                    
                    5.5 TCP最大连接数
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../">
            
                <a href="../">
            
                    
                    6 ZooKeeper
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.7.1" data-path="ZooKeeper集群安装.html">
            
                <a href="ZooKeeper集群安装.html">
            
                    
                    6.1 ZooKeeper集群安装
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="ZooKeeper权限控制.html">
            
                <a href="ZooKeeper权限控制.html">
            
                    
                    6.2 ZooKeeper权限控制
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="ZooKeeperWatcher.html">
            
                <a href="ZooKeeperWatcher.html">
            
                    
                    6.3 ZooKeeperWatcher
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="ZooKeeper连接.html">
            
                <a href="ZooKeeper连接.html">
            
                    
                    6.4 ZooKeeper连接
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../pic/PIC.html">
            
                <a href="../pic/PIC.html">
            
                    
                    7 Pic
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../">
            
                <a href="../">
            
                    
                    8 Other
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../other/GitBook.html">
            
                <a href="../other/GitBook.html">
            
                    
                    1 GitBook
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../other/MySQL.html">
            
                <a href="../other/MySQL.html">
            
                    
                    2 MySQL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../other/MD语法.html">
            
                <a href="../other/MD语法.html">
            
                    
                    3 MarkDown
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="../other/windows相关.html">
            
                <a href="../other/windows相关.html">
            
                    
                    4 Windows相关
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.5" data-path="../other/Sublime Text 3 快捷键精华版.html">
            
                <a href="../other/Sublime Text 3 快捷键精华版.html">
            
                    
                    5 SublimeText3快捷键精华版
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.6" data-path="../other/zabbix.html">
            
                <a href="../other/zabbix.html">
            
                    
                    6 Zabbix
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.7" data-path="../other/Nginx安装.html">
            
                <a href="../other/Nginx安装.html">
            
                    
                    7 Nginx
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.8" data-path="../other/TBSchedule.html">
            
                <a href="../other/TBSchedule.html">
            
                    
                    8 TBSchedule
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.9" data-path="../other/webdis安装.html">
            
                <a href="../other/webdis安装.html">
            
                    
                    9 webdis安装
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >6.1 ZooKeeper集群安装</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h3 id="1-&#x914D;&#x7F6E;zoocfg&#x6587;&#x4EF6;">1 &#x914D;&#x7F6E;zoo.cfg&#x6587;&#x4EF6;:</h3>
<pre><code>tickTime=2000
initLimit=10
syncLimit=5
clientPort=2181
dataDir=/export/search/zookeeper-cluster/zookeeper-3.4.6-node1/data
server.1=localhost:2887:3887
server.2=localhost:2888:3888
server.3=localhost:2889:3889
</code></pre><ul>
<li>tickTime=2000</li>
</ul>
<p>tickTime&#x8FD9;&#x4E2A;&#x65F6;&#x95F4;&#x662F;&#x4F5C;&#x4E3A;Zookeeper&#x670D;&#x52A1;&#x5668;&#x4E4B;&#x95F4;&#x6216;&#x5BA2;&#x6237;&#x7AEF;&#x4E0E;&#x670D;&#x52A1;&#x5668;&#x4E4B;&#x95F4;&#x7EF4;&#x6301;&#x5FC3;&#x8DF3;&#x7684;&#x65F6;&#x95F4;&#x95F4;&#x9694;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x6BCF;&#x4E2A;tickTime&#x65F6;&#x95F4;&#x5C31;&#x4F1A;&#x53D1;&#x9001;&#x4E00;&#x4E2A;&#x5FC3;&#x8DF3;&#xFF1B;</p>
<ul>
<li>initLimit=10</li>
</ul>
<p>initLimit&#x8FD9;&#x4E2A;&#x914D;&#x7F6E;&#x9879;&#x662F;&#x7528;&#x6765;&#x914D;&#x7F6E;Zookeeper&#x63A5;&#x53D7;&#x5BA2;&#x6237;&#x7AEF;&#xFF08;&#x8FD9;&#x91CC;&#x6240;&#x8BF4;&#x7684;&#x5BA2;&#x6237;&#x7AEF;&#x4E0D;&#x662F;&#x7528;&#x6237;&#x8FDE;&#x63A5;Zookeeper&#x670D;&#x52A1;&#x5668;&#x7684;&#x5BA2;&#x6237;&#x7AEF;&#xFF0C;&#x800C;&#x662F;Zookeeper&#x670D;&#x52A1;&#x5668;&#x96C6;&#x7FA4;&#x4E2D;&#x8FDE;&#x63A5;&#x5230;Leader&#x7684;Follower &#x670D;&#x52A1;&#x5668;&#xFF09;&#x521D;&#x59CB;&#x5316;&#x8FDE;&#x63A5;&#x65F6;&#x6700;&#x957F;&#x80FD;&#x5FCD;&#x53D7;&#x591A;&#x5C11;&#x4E2A;&#x5FC3;&#x8DF3;&#x65F6;&#x95F4;&#x95F4;&#x9694;&#x6570;&#x3002;
&#x5F53;&#x5DF2;&#x7ECF;&#x8D85;&#x8FC7;10&#x4E2A;&#x5FC3;&#x8DF3;&#x7684;&#x65F6;&#x95F4;&#xFF08;&#x4E5F;&#x5C31;&#x662F;tickTime&#xFF09;&#x957F;&#x5EA6;&#x540E; Zookeeper &#x670D;&#x52A1;&#x5668;&#x8FD8;&#x6CA1;&#x6709;&#x6536;&#x5230;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x8FD4;&#x56DE;&#x4FE1;&#x606F;&#xFF0C;&#x90A3;&#x4E48;&#x8868;&#x660E;&#x8FD9;&#x4E2A;&#x5BA2;&#x6237;&#x7AEF;&#x8FDE;&#x63A5;&#x5931;&#x8D25;&#x3002;&#x603B;&#x7684;&#x65F6;&#x95F4;&#x957F;&#x5EA6;&#x5C31;&#x662F; 10*2000=20 &#x79D2;&#xFF1B;</p>
<ul>
<li>syncLimit=5</li>
</ul>
<p>syncLimit&#x8FD9;&#x4E2A;&#x914D;&#x7F6E;&#x9879;&#x6807;&#x8BC6;Leader&#x4E0E;Follower&#x4E4B;&#x95F4;&#x53D1;&#x9001;&#x6D88;&#x606F;&#xFF0C;&#x8BF7;&#x6C42;&#x548C;&#x5E94;&#x7B54;&#x65F6;&#x95F4;&#x957F;&#x5EA6;&#xFF0C;&#x6700;&#x957F;&#x4E0D;&#x80FD;&#x8D85;&#x8FC7;&#x591A;&#x5C11;&#x4E2A;tickTime&#x7684;&#x65F6;&#x95F4;&#x957F;&#x5EA6;&#xFF0C;&#x603B;&#x7684;&#x65F6;&#x95F4;&#x957F;&#x5EA6;&#x5C31;&#x662F;5*2000=10&#x79D2;&#xFF1B;</p>
<ul>
<li>dataDir=/export/search/zookeeper-cluster/zookeeper-3.4.6-node1/data</li>
</ul>
<p>dataDir&#x987E;&#x540D;&#x601D;&#x4E49;&#x5C31;&#x662F;Zookeeper&#x4FDD;&#x5B58;&#x6570;&#x636E;&#x7684;&#x76EE;&#x5F55;&#xFF0C;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;Zookeeper&#x5C06;&#x5199;&#x6570;&#x636E;&#x7684;&#x65E5;&#x5FD7;&#x6587;&#x4EF6;&#x4E5F;&#x4FDD;&#x5B58;&#x5728;&#x8FD9;&#x4E2A;&#x76EE;&#x5F55;&#x91CC;&#xFF1B;</p>
<ul>
<li>clientPort=2181</li>
</ul>
<p>clientPort&#x8FD9;&#x4E2A;&#x7AEF;&#x53E3;&#x5C31;&#x662F;&#x5BA2;&#x6237;&#x7AEF;&#x8FDE;&#x63A5;Zookeeper&#x670D;&#x52A1;&#x5668;&#x7684;&#x7AEF;&#x53E3;&#xFF0C;Zookeeper&#x4F1A;&#x76D1;&#x542C;&#x8FD9;&#x4E2A;&#x7AEF;&#x53E3;&#x63A5;&#x53D7;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x8BBF;&#x95EE;&#x8BF7;&#x6C42;&#xFF1B;</p>
<ul>
<li>server.A=B:C:D<pre><code>server.1=localhost:2887:3887
server.2=localhost:2888:3888
server.3=localhost:2889:3889
</code></pre></li>
</ul>
<p>A&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#xFF0C;&#x8868;&#x793A;&#x8FD9;&#x4E2A;&#x662F;&#x7B2C;&#x51E0;&#x53F7;&#x670D;&#x52A1;&#x5668;&#xFF1B;
B&#x662F;&#x8FD9;&#x4E2A;&#x670D;&#x52A1;&#x5668;&#x7684;ip&#x5730;&#x5740;&#xFF1B;
C&#x7B2C;&#x4E00;&#x4E2A;&#x7AEF;&#x53E3;&#x7528;&#x6765;&#x96C6;&#x7FA4;&#x6210;&#x5458;&#x7684;&#x4FE1;&#x606F;&#x4EA4;&#x6362;&#xFF0C;&#x8868;&#x793A;&#x7684;&#x662F;&#x8FD9;&#x4E2A;&#x670D;&#x52A1;&#x5668;&#x4E0E;&#x96C6;&#x7FA4;&#x4E2D;&#x7684;Leader&#x670D;&#x52A1;&#x5668;&#x4EA4;&#x6362;&#x4FE1;&#x606F;&#x7684;&#x7AEF;&#x53E3;&#xFF1B;
D&#x662F;&#x5728;leader&#x6302;&#x6389;&#x65F6;&#x4E13;&#x95E8;&#x7528;&#x6765;&#x8FDB;&#x884C;&#x9009;&#x4E3E;leader&#x6240;&#x7528;&#x3002;</p>
<h3 id="2-&#x521B;&#x5EFA;serverid&#x6807;&#x8BC6;">2 &#x521B;&#x5EFA;ServerID&#x6807;&#x8BC6;</h3>
<p>&#x9664;&#x4E86;&#x4FEE;&#x6539;zoo.cfg&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x96C6;&#x7FA4;&#x6A21;&#x5F0F;&#x4E0B;&#x8FD8;&#x8981;&#x914D;&#x7F6E;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;myid&#xFF0C;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x5728;dataDir&#x76EE;&#x5F55;&#x4E0B;&#xFF0C;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x91CC;&#x9762;&#x5C31;&#x6709;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x5C31;&#x662F;A&#x7684;&#x503C;&#xFF0C;&#x5728;&#x4E0A;&#x9762;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;zoo.cfg&#x4E2D;&#x914D;&#x7F6E;&#x7684;dataDir&#x8DEF;&#x5F84;&#x4E2D;&#x521B;&#x5EFA;myid&#x6587;&#x4EF6;</p>
<pre><code>cat /export/search/zookeeper-cluster/zookeeper-3.4.6-node1/data/myid
1
</code></pre><p>server.X &#x8FD9;&#x4E2A;&#x6570;&#x5B57;&#x5C31;&#x662F;&#x5BF9;&#x5E94; data/myid&#x4E2D;&#x7684;&#x6570;&#x5B57;&#x3002;&#x4F60;&#x5728;3&#x4E2A;server&#x7684;myid&#x6587;&#x4EF6;&#x4E2D;&#x5206;&#x522B;&#x5199;&#x5165;&#x4E86;1&#xFF0C;2&#xFF0C;3&#xFF0C;&#x90A3;&#x4E48;&#x6BCF;&#x4E2A;server&#x4E2D;&#x7684;zoo.cfg&#x90FD;&#x914D; server.1&#xFF0C;server.2&#xFF0C;server.3 &#x5C31;OK&#x4E86;</p>
<h3 id="3-&#x542F;&#x52A8;zookeeper">3 &#x542F;&#x52A8;zookeeper</h3>
<pre><code>bin/zkServer.sh start
</code></pre><h3 id="4-&#x68C0;&#x6D4B;&#x96C6;&#x7FA4;&#x662F;&#x5426;&#x542F;&#x52A8;">4 &#x68C0;&#x6D4B;&#x96C6;&#x7FA4;&#x662F;&#x5426;&#x542F;&#x52A8;</h3>
<pre><code>bin/zkCli.sh -server IP:2181
bin/zkCli.sh
</code></pre><h3 id="5-&#x5E38;&#x7528;&#x547D;&#x4EE4;">5 &#x5E38;&#x7528;&#x547D;&#x4EE4;</h3>
<pre><code>1. &#x542F;&#x52A8;ZK&#x670D;&#x52A1;:       sh bin/zkServer.sh start
2. &#x67E5;&#x770B;ZK&#x670D;&#x52A1;&#x72B6;&#x6001;:       sh bin/zkServer.sh status
3. &#x505C;&#x6B62;ZK&#x670D;&#x52A1;:       sh bin/zkServer.sh stop
4. &#x91CD;&#x542F;ZK&#x670D;&#x52A1;:       sh bin/zkServer.sh restart
</code></pre><h3 id="6-&#x5B98;&#x65B9;&#x5EFA;&#x8BAE;">6 &#x5B98;&#x65B9;&#x5EFA;&#x8BAE;</h3>
<h4 id="what-are-the-options-process-for-upgrading-zookeeper">What are the options-process for upgrading ZooKeeper?</h4>
<p>There are two primary ways of doing this; 1) full restart or 2) rolling restart.</p>
<p>In the full restart case you can stage your updated code/configuration/etc..., stop all of the servers in the ensemble, switch code/configuration, and restart the ZooKeeper ensemble. If you do this programmatically (scripts typically, ie not by hand) the restart can be done on order of seconds. As a result the clients will lose connectivity to the ZooKeeper cluster during this time, however it looks to the clients just like a network partition. All existing client sessions are maintained and re-established as soon as the ZooKeeper ensemble comes back up. Obviously one drawback to this approach is that if you encounter any issues (it&apos;s always a good idea to test/stage these changes on a test harness) the cluster may be down for longer than expected.</p>
<p>&#x65B9;&#x6848;&#x4E00;&#xFF0C;&#x5168;&#x90E8;&#x505C;&#x6B62;&#x91CD;&#x542F;&#x3002;</p>
<p>The second option, preferable for many users, is to do a &quot;rolling restart&quot;. In this case you upgrade one server in the ZooKeeper ensemble at a time; bring down the server, upgrade the code/configuration/etc..., then restart the server. The server will automatically rejoin the quorum, update it&apos;s internal state with the current ZK leader, and begin serving client sessions. As a result of doing a rolling restart, rather than a full restart, the administrator can monitor the ensemble as the upgrade progresses, perhaps rolling back if any issues are encountered.</p>
<p>&#x5EFA;&#x8BAE;&#x91C7;&#x7528;&#x7B2C;&#x4E8C;&#x65B9;&#x6848;&#xFF0C;&#x96C6;&#x7FA4;&#x4F9D;&#x6B21;&#x91CD;&#x542F;&#x3002;</p>
<h4 id="how-do-i-size-a-zookeeper-ensemble-cluster">How do I size a ZooKeeper ensemble (cluster)?</h4>
<p>In general when determining the number of ZooKeeper serving nodes to deploy (the size of an ensemble) you need to think in terms of reliability, and not performance.</p>
<p>Reliability:</p>
<p>A single ZooKeeper server (standalone) is essentially a coordinator with no reliability (a single serving node failure brings down the ZK service).</p>
<p>A 3 server ensemble (you need to jump to 3 and not 2 because ZK works based on simple majority voting) allows for a single server to fail and the service will still be available.</p>
<p>So if you want reliability go with at least 3. We typically recommend having 5 servers in &quot;online&quot; production serving environments. This allows you to take 1 server out of service (say planned maintenance) and still be able to sustain an unexpected outage of one of the remaining servers w/o interruption of the service.</p>
<p>Performance:</p>
<p>Write performance actually decreases as you add ZK servers, while read performance increases modestly: <a href="http://zookeeper.apache.org/doc/current/zookeeperOver.html#Performance" target="_blank">http://zookeeper.apache.org/doc/current/zookeeperOver.html#Performance</a></p>
<p>See this page for a survey Patrick Hunt (<a href="http://twitter.com/phunt" target="_blank">http://twitter.com/phunt</a>) did looking at operational latency with both standalone server and an ensemble of size 3. You&apos;ll notice that a single core machine running a standalone ZK ensemble (1 server) is still able to process 15k requests per second. This is orders of magnitude greater than what most applications require (if they are using ZooKeeper correctly - ie as a coordination service, and not as a replacement for a database, filestore, cache, etc...)</p>
<h3 id="&#x6269;&#x5C55;&#x9605;&#x8BFB;">&#x6269;&#x5C55;&#x9605;&#x8BFB;</h3>
<h4 id="1-zookeeper-faq">1. ZOOKEEPER FAQ</h4>
<p><a href="https://cwiki.apache.org/confluence/display/ZOOKEEPER/FAQ" target="_blank">https://cwiki.apache.org/confluence/display/ZOOKEEPER/FAQ</a></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../" class="navigation navigation-prev " aria-label="Previous page: 6 ZooKeeper">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="ZooKeeper权限控制.html" class="navigation navigation-next " aria-label="Next page: 6.2 ZooKeeper权限控制">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"6.1 ZooKeeper集群安装","level":"1.7.1","depth":2,"next":{"title":"6.2 ZooKeeper权限控制","level":"1.7.2","depth":2,"path":"zookeeper/ZooKeeper权限控制.md","ref":"zookeeper/ZooKeeper权限控制.md","articles":[]},"previous":{"title":"6 ZooKeeper","level":"1.7","depth":1,"path":"README.md","ref":"README.md","articles":[{"title":"6.1 ZooKeeper集群安装","level":"1.7.1","depth":2,"path":"zookeeper/ZooKeeper集群安装.md","ref":"zookeeper/ZooKeeper集群安装.md","articles":[]},{"title":"6.2 ZooKeeper权限控制","level":"1.7.2","depth":2,"path":"zookeeper/ZooKeeper权限控制.md","ref":"zookeeper/ZooKeeper权限控制.md","articles":[]},{"title":"6.3 ZooKeeperWatcher","level":"1.7.3","depth":2,"path":"zookeeper/ZooKeeperWatcher.md","ref":"zookeeper/ZooKeeperWatcher.md","articles":[]},{"title":"6.4 ZooKeeper连接","level":"1.7.4","depth":2,"path":"zookeeper/ZooKeeper连接.md","ref":"zookeeper/ZooKeeper连接.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"zookeeper/ZooKeeper集群安装.md","mtime":"2018-06-26T13:27:35.563Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-06-26T13:49:56.226Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

